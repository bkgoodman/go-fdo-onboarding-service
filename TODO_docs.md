# Documentation fixes

This should all apply to "README.md" file.

I think we need to make some holistic changes to docs.

## Intial

Up front I think we want to talk more about what this is and what it does. i.e. The purpose here is to act as in "in-factory" manufacturing station to initialize FDO devices. This effectibley means that this is a separate service that will sit on a factory floor and receive vouchers from newly manufactured devices. 

Basic steps implying:
- Receive vouchers from new devices
- Sign vouchers over to next "recipeint" (discussed below)
- Store, record and or transmit vouchers for subsqeunt use

(Now we can break out what this means)

## Signing
When we create an ownership voucher, and sign it over to a new owner, we need to sign it over to a new owner. This is done using a well-known private key to identify the factory from which it came. This is the "signer". It needs to be _secure_, in that it is the fact that vouchers from this factory are signed with this key which gives us the trust and assurange that they were generated by this factory.

Often times factories will has a high-security HSM to provide such signing capabilities. The HSMs are secured key managmeent devices. They don't know anything about FDO, but are more like a rubber-stamp bolted to a factory floor. You know the stamp is legitimate, because the security of it tells us it MUST have been signed the HSM in this factory. Thus, in scanarios where factories have an HSM, we provide a _callback_ mechanism to allow the factory to sign with that HSMs. HSMs range from complex external in-factory, caged systems - to smaller USB devices which can integrated directly into the manufacturing station.

In simpler scenarios, ones where:

- Trust is less crucial (maybe a test or in-house emphmeral system)
- Trust need be shorter-lived (i.e. in-factory system is immediatley deliver vouchers to a more trusted system)
- The Manufacutring Station is believed to be highly secured and trusted itself
- Cost and/or complexity of manufacturing systems is a major concern

Maybe we need-not use an external HSM.In such cases - we can just use a private key stored directly in our application. This key can be created on first-time startup via configuration or command line options.

## Extension (Signover or Ownership Extension)
When creating a voucher, an owner needs to be initially assigned. This may or may not be the final, ultimate customer (recepient) of the device, but one must be specified initially. There are a few common was in which this is done:

### Well-Known (Static) Owner
This simply means "Sign over to well-known owner". This is the most common case, where the factory floor itself doesn't directly know or care who the final recipient is, but it knows it is going to a well-known owner. Examples include cases where an OEM is building batches of machines for a single reseller, or a factory is pumping out devices to _stock_ which will be subsequently sold. Other cases include where there is "main" voucher system elsewhere which will be collecting _all_ voucher, and assining them over outside the factory process. In any of these cases - we simply specify a well-known new-owner key to which all devices will be transfred to. It is "static" in that  _all_ devices are _always_ simply signed over to this key.

### Dynamic Owner Key
In other cases, such as ones where deviecs are being built to-order by specific customers, or manufactuered for specific resellers - maybe we want to transfer devices to those recipients directly. i.e. Machines manufactuered for one Reseller-A all are signed over Reseller-A-Key, whereas devices for Reseller-B are all signed over to Reseller-B-Key. 

Our manufacturing station doesn't know anything about which devices are being manufactured for which customers, nor what their keys are. It is only the _existing_ factory systems that may have this kind of information - ie. only it knows which machines are being manfuactured for whom. For this reason, we provide a _callback_ mechanism which allows factories to take the serial number of a device, and return the appropriate key to sign it over to.


## Store and/or Transmit

After we've created, transfered (to someone else) and sign (with out key) a voucher, we need to do something with it. There are multiple options, and they we can do any of them, or all of them:

### Store it in a database
By default, this implementation uses an sqlite database. Vouchers will be stored in it (unless disabled)

### Transmit it to a remote system
We provide a callback mechanism to transfer elsewhere. Just like we discused above, this COULD be as simple as "all devices go to  a well-known, pre-defined, static corportate HQ system". In this case, we could use a generic curl command to transfer the voucher to a remote system, or even a custom script to do so.

In other cases, just like as-in signover keying, we may need to be more selective as to _where_ to send vouchers for _specific_ devices going to _specific_ customers or resellers. In this case we provide a mechanism to pass device serial number to a user-defined callback. This callback integrate with other factory systems to look up the correct, specific destination for specific customers, and transmit there.

This implementation simply calls the factory-define callback (shell command or script). It is up to the implementation to deal with any problems or errors - including transient issues like network outages.

### Save it to disk
If configured, all vouchers will simply be stored in a directory on the system after creation. It is then up to the user to determine what do do with them next. This can also be used as a backup for other mechanisms that may have subsqeuent loss or failure.

## OVEExtraData
FDO provides a mechanism to add arbitrary data to the voucher. This is often used to add metadata about the device beyhond what is specified in the voucher, such hardware configuration, ordering information, etc. It is completely up to the manufacturer (or entity extending ownership) to define what this data is, and how it is used. 

This implementation provides a callback mechanism to allow the factory to add this data to the voucher.

This is optional, and can be simply not-implemented if needed. OVEExtraData is convientent for times when you might need data to reference what a voucher is for that may not be apparent from the other data (serial number or GUID) already in the voucher. Or the control plane may need to receive some identifying information about the device _before_ the device actually onboards.

It is also important to note, that as FDO Ownership Vouchers are not concidered to be private - no information in the voucher should be considered private. Thus, identifying information like names, emails, etc. should not be included in the voucher. Always concider anonymity concerns when adding data to vouchers.

## Callbacks
Everything above may be done in conjunction with some other "factory systems". This generally involves other systems that the factory has that knows about things going on with these devices, specifically including:

- What devices are being manaufactuered (i.e. serial number)
- What orders these devices are associated with (order number)
- Which customers these devices are being manfuactuered for (customer)
- The keys required to sign vouchers over to (per above)

So we define callbacks to allow FDO to be tied into other system for manufacutring. 

This implementation has defined the ability to add such callbacks as external shell commands (e.g. curl commands or scripts) which can be called to send or receive this data from other systems. Implementations MAY simply use those.

Other implementations may wish to define their own callbacks more integrated, replacing the exsting functions in this application, directly. 